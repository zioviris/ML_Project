"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[7023],{94448:function(e,s,t){t.r(s),t.d(s,{CompareModelVersionsPage:function(){return G},CompareModelVersionsPageImpl:function(){return O},default:function(){return J}});var r=t(31014),a=t(51079),i=t.n(a),o=t(10811),n=t(26809),l=t(7204),d=t(69708),c=t(53140),u=t(89555),h=t(93215),m=t(9133),p=t.n(m),g=t(88443),f=t(64912),v=t(3293),b=t(77520),M=t(42848),y=t(72877),I=t(51882),Y=t(7871),A=t(87234),N=t(58481),R=t(85017),S=t(24406),w=t(76010),T=t(55406),C=t(69869),D=t(65871),k=t(79085),q=t(10405),H=t(50111);const{TabPane:F}=v.Y6f;function x(e){const{theme:s}=(0,b.u)();return(0,H.Y)("div",{css:(0,u.AH)({textAlign:"center",color:s.colors.textSecondary},""),...e})}class P extends r.Component{constructor(e){super(e),this.compareModelVersionViewRef=void 0,this.state={inputActive:!0,outputActive:!0,onlyShowParameterDiff:!0,onlyShowSchemaDiff:!0,onlyShowMetricDiff:!0,compareByColumnNameToggle:!1},this.icons={plusIcon:(0,H.Y)("i",{className:"far fa-plus-square-o"}),minusIcon:(0,H.Y)("i",{className:"far fa-minus-square-o"}),downIcon:(0,H.Y)("i",{className:"fas fa-caret-down"}),rightIcon:(0,H.Y)("i",{className:"fas fa-caret-right"}),chartIcon:(0,H.Y)("i",{className:"fas fa-line-chart padding-left-text"})},this.onToggleClick=e=>{this.setState((s=>({[e]:!s[e]})))},this.compareModelVersionViewRef=r.createRef(),this.onCompareModelTableScrollHandler=this.onCompareModelTableScrollHandler.bind(this)}onCompareModelTableScrollHandler(e){var s;const t=null===(s=this.compareModelVersionViewRef.current)||void 0===s?void 0:s.querySelectorAll(".compare-model-table");t.forEach(((s,r)=>{const a=t[r];a!==e.target&&(a.scrollLeft=e.target.scrollLeft)}))}getTableHeaderColumnWidth(){return{width:"200px",minWidth:"200px",maxWidth:"200px"}}getTableBodyColumnWidth(){const e=`max(200px, calc(100vw / ${this.props.runInfos.length}))`;return{width:e,minWidth:e,maxWidth:e}}render(){const{inputsListByIndex:e,inputsListByName:s,modelName:t,outputsListByIndex:r,outputsListByName:a,runInfos:i,runUuids:o,runDisplayNames:n,paramLists:l,metricLists:d,intl:c}=this.props,u=(0,H.Y)(g.A,{id:"6kSKRk",defaultMessage:"Comparing {numVersions} Versions",values:{numVersions:this.props.runInfos.length}}),m=[(0,H.Y)(h.N_,{to:C.f.modelListPageRoute,children:(0,H.Y)(g.A,{id:"U82iv6",defaultMessage:"Registered Models"})}),(0,H.Y)(h.N_,{to:C.f.getModelPageRoute(t),children:t})],p=c.formatMessage({id:"K32dke",defaultMessage:"Show diff only"});return(0,H.FD)("div",{children:[(0,H.Y)(k.z,{title:u,breadcrumbs:m}),(0,H.FD)("div",{ref:this.compareModelVersionViewRef,children:[this.renderTable((0,H.FD)(H.FK,{children:[this.renderTableHeader(),this.renderModelVersionInfo()]})),(0,H.FD)(q.i,{title:c.formatMessage({id:"bSx/er",defaultMessage:"Parameters"}),children:[(0,H.Y)(v.dOG,{componentId:"mlflow.model-registry.compare-model-versions-parameters-diff-switch",label:p,checked:this.state.onlyShowParameterDiff,onChange:(e,s)=>this.setState({onlyShowParameterDiff:e})}),(0,H.Y)(M.S,{size:"sm"}),this.renderTable(this.renderParams())]}),(0,H.FD)(q.i,{title:c.formatMessage({id:"cK6riy",defaultMessage:"Schema"}),children:[(0,H.Y)(v.dOG,{componentId:"mlflow.model-registry.compare-model-versions-schema-ignore-column-order-switch",label:c.formatMessage({id:"sXqvoN",defaultMessage:"Ignore column ordering"}),checked:this.state.compareByColumnNameToggle,onChange:(e,s)=>this.setState({compareByColumnNameToggle:e})}),(0,H.Y)(M.S,{size:"sm"}),(0,H.Y)(v.dOG,{componentId:"mlflow.model-registry.compare-model-versions-schema-diff-switch",label:p,checked:this.state.onlyShowSchemaDiff,onChange:(e,s)=>this.setState({onlyShowSchemaDiff:e})}),(0,H.Y)(M.S,{size:"sm"}),(0,H.FD)("div",{children:[this.renderSchemaSectionHeader("inputActive",(0,H.Y)(g.A,{id:"GJWVBA",defaultMessage:"Inputs"})),this.state.inputActive&&(0,H.Y)(H.FK,{children:this.renderTable(this.renderSchema("inputActive",(0,H.Y)(g.A,{id:"ThrXMh",defaultMessage:"Inputs"}),e,s))})]}),(0,H.Y)(M.S,{size:"sm"}),(0,H.FD)("div",{children:[this.renderSchemaSectionHeader("outputActive",(0,H.Y)(g.A,{id:"aB6xFd",defaultMessage:"Outputs"})),this.state.outputActive&&(0,H.Y)(H.FK,{children:this.renderTable(this.renderSchema("outputActive",(0,H.Y)(g.A,{id:"bqn2bk",defaultMessage:"Outputs"}),r,a))})]})]}),(0,H.FD)(q.i,{title:c.formatMessage({id:"CpLnGS",defaultMessage:"Metrics"}),children:[(0,H.Y)(v.dOG,{componentId:"mlflow.model-registry.compare-model-versions-metrics-diff-switch",label:p,checked:this.state.onlyShowMetricDiff,onChange:(e,s)=>this.setState({onlyShowMetricDiff:e})}),(0,H.Y)(M.S,{size:"sm"}),this.renderTable(this.renderMetrics())]})]}),(0,H.FD)(v.Y6f,{children:[(0,H.Y)(F,{tab:(0,H.Y)(g.A,{id:"QuU1sl",defaultMessage:"Parallel Coordinates Plot"}),children:(0,H.Y)(T.Ay,{runUuids:o})},"parallel-coordinates-plot"),(0,H.Y)(F,{tab:(0,H.Y)(g.A,{id:"4NEPlV",defaultMessage:"Scatter Plot"}),children:(0,H.Y)(I.J,{runUuids:o,runDisplayNames:n})},"scatter-plot"),(0,H.Y)(F,{tab:(0,H.Y)(g.A,{id:"iXb99e",defaultMessage:"Box Plot"}),children:(0,H.Y)(Y.e,{runUuids:o,runInfos:i,paramLists:l,metricLists:d})},"box-plot"),(0,H.Y)(F,{tab:(0,H.Y)(g.A,{id:"dq8MJd",defaultMessage:"Contour Plot"}),children:(0,H.Y)(A.A,{runUuids:o,runDisplayNames:n})},"contour-plot")]})]})}renderTable(e){return(0,H.Y)(v.XIK,{className:"table compare-table compare-model-table",onScroll:this.onCompareModelTableScrollHandler,children:e})}renderTableHeader(){const{runInfos:e,runInfosValid:s}=this.props;return(0,H.FD)(v.Hjg,{className:"compare-table-row",children:[(0,H.Y)(v.nA6,{className:"head-value sticky-header",css:(0,u.AH)({backgroundColor:"var(--table-header-background-color)",...this.getTableHeaderColumnWidth()},""),children:(0,H.Y)(g.A,{id:"bi26D5",defaultMessage:"Run ID:"})}),e.map(((e,t)=>{var r,a;return(0,H.Y)(v.nA6,{className:"data-value",css:(0,u.AH)({...this.getTableBodyColumnWidth()},""),children:s[t]?(0,H.Y)(h.N_,{to:N.h.getRunPageRoute(null!==(r=e.experimentId)&&void 0!==r?r:"0",null!==(a=e.runUuid)&&void 0!==a?a:""),children:e.runUuid}):e.runUuid},e.runUuid)}))]})}renderModelVersionInfo(){const{runInfos:e,runInfosValid:s,versionsToRuns:t,runNames:r,modelName:a}=this.props;return(0,H.FD)(H.FK,{children:[(0,H.FD)(v.Hjg,{className:"compare-table-row",children:[(0,H.Y)(v.nA6,{className:"head-value sticky-header",css:(0,u.AH)({backgroundColor:"var(--table-header-background-color)",...this.getTableHeaderColumnWidth()},""),children:(0,H.Y)(g.A,{id:"xmPKKq",defaultMessage:"Model Version:"})}),Object.keys(t).map((e=>{const s=t[e];return(0,H.Y)(v.nA6,{className:"data-value",css:(0,u.AH)({...this.getTableBodyColumnWidth()},""),children:(0,H.Y)(h.N_,{to:C.f.getModelVersionPageRoute(a,e),children:e})},s)}))]}),(0,H.FD)(v.Hjg,{className:"compare-table-row",children:[(0,H.Y)(v.nA6,{className:"head-value sticky-header",css:(0,u.AH)({backgroundColor:"var(--table-header-background-color)",...this.getTableHeaderColumnWidth()},""),children:(0,H.Y)(g.A,{id:"erqoIC",defaultMessage:"Run Name:"})}),r.map(((s,t)=>(0,H.Y)(v.nA6,{className:"data-value",css:(0,u.AH)({...this.getTableBodyColumnWidth()},""),children:(0,H.Y)("div",{className:"truncate-text single-line cell-content",children:s})},e[t].runUuid)))]}),(0,H.FD)(v.Hjg,{className:"compare-table-row",children:[(0,H.Y)(v.nA6,{className:"head-value sticky-header",css:(0,u.AH)({backgroundColor:"var(--table-header-background-color)",...this.getTableHeaderColumnWidth()},""),children:(0,H.Y)(g.A,{id:"GKiPV1",defaultMessage:"Start Time:"})}),e.map(((e,t)=>{const r=e.startTime&&s[t]?w.A.formatTimestamp(e.startTime,this.props.intl):"(unknown)";return(0,H.Y)(v.nA6,{className:"data-value",css:(0,u.AH)({...this.getTableBodyColumnWidth()},""),children:r},e.runUuid)}))]})]})}renderParams(){return(0,H.Y)(H.FK,{children:this.renderDataRows(this.props.paramLists,(0,H.Y)(g.A,{id:"EK5JxG",defaultMessage:"Parameters"}),!0,this.state.onlyShowParameterDiff)})}renderSchemaSectionHeader(e,s){const t=this.state[e],{minusIcon:r,plusIcon:a}=this.icons;return(0,H.FD)("button",{onClick:()=>this.onToggleClick(e),children:[t?r:a,(0,H.Y)("strong",{style:{paddingLeft:4},children:s})]})}renderSchema(e,s,t,r){const{compareByColumnNameToggle:a}=this.state,i=this.state[e],o=!a&&!p().isEmpty(t),n=a&&!p().isEmpty(r),l=e=>e,d=(0,H.Y)(g.A,{id:"5RWIet",defaultMessage:"Schema {sectionName}",values:{sectionName:s}});return(0,H.FD)(H.FK,{children:[this.renderDataRows(t,d,i&&o,this.state.onlyShowSchemaDiff,((e,t)=>(0,H.FD)(H.FK,{children:[s," [",e,"]"]})),l),this.renderDataRows(r,d,i&&n,this.state.onlyShowSchemaDiff,((e,s)=>e),l)]})}renderMetrics(){const{runInfos:e,metricLists:s}=this.props,{chartIcon:t}=this.icons;return(0,H.Y)(H.FK,{children:this.renderDataRows(s,(0,H.Y)(g.A,{id:"GDenB3",defaultMessage:"Metrics"}),!0,this.state.onlyShowMetricDiff,((s,r)=>(0,H.FD)(h.N_,{to:N.h.getMetricPageRoute(e.map((e=>e.runUuid)).filter(((e,s)=>void 0!==r[s])),s,[e[0].experimentId]),target:"_blank",title:"Plot chart",children:[s,t]})),w.A.formatMetric)})}renderDataRows(e,s){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(e,s)=>e,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e=>isNaN(e)?`"${e}"`:e;const o=S.A.getKeys(e),n={};if(o.forEach((e=>n[e]=[])),e.forEach(((e,s)=>{o.forEach((e=>n[e].push(void 0))),e.forEach((e=>n[e.key][s]=e.value))})),p().isEmpty(o)||p().isEmpty(e))return(0,H.Y)(v.Hjg,{className:"compare-table-row",children:(0,H.Y)(v.nA6,{className:"head-value sticky-header",css:(0,u.AH)({backgroundColor:"var(--table-header-background-color)",...this.getTableHeaderColumnWidth()},""),children:(0,H.Y)(x,{children:(0,H.Y)(g.A,{id:"47QsAK",defaultMessage:"{fieldName} are empty",values:{fieldName:s}})})})});p().every(o,(e=>!isNaN(e)))?o.sort(((e,s)=>parseInt(e,10)-parseInt(s,10))):o.sort();let l=!0;const d=o.map((e=>{const s=n[e].length>1&&p().uniq(n[e]).length>1;return r&&!s?null:(l=!s&&l,(0,H.FD)(v.Hjg,{style:{display:""+(r&&!s||!t?"none":"")},className:"compare-table-row "+(s?"diff-row":""),children:[(0,H.Y)(v.nA6,{className:"head-value sticky-header",css:(0,u.AH)({backgroundColor:"var(--table-header-background-color)",...this.getTableHeaderColumnWidth()},""),children:a(e,n[e])}),n[e].map(((e,s)=>(0,H.Y)(v.nA6,{className:"data-value",css:(0,u.AH)({...this.getTableBodyColumnWidth()},""),children:(0,H.Y)("span",{className:"truncate-text single-line cell-content",children:void 0===e?"-":i(e)})},this.props.runInfos[s].runUuid)))]},e))}));return l&&r?(0,H.Y)(v.Hjg,{className:"compare-table-row",style:{display:""+(t?"":"none")},children:(0,H.Y)(v.nA6,{className:"data-value",css:(0,u.AH)({...this.getTableBodyColumnWidth()},""),children:(0,H.Y)(x,{children:(0,H.Y)(g.A,{id:"NJ1bYP",defaultMessage:"{fieldName} are identical",values:{fieldName:s}})})})}):d}}const V=e=>{const s={};return e.forEach(((e,t)=>{const r=e.name?e.name:"",a=e.type?e.type:"";s[t]={key:t,value:""!==r&&""!==a?`${r}: ${a}`:`${r}${a}`}})),s},B=e=>{const s={};return e.forEach((e=>{const t=e.name?e.name:"-",r=e.type?e.type:"-";s[t]={key:t,value:r}})),s},L=(0,o.Ng)(((e,s)=>{const t=[],r=[],a=[],i=[],o=[],n=[],l=[],{modelName:d,versionsToRuns:c}=s,u=[],h=[],m=[],p=[];for(const g in c)if(c&&g in c){const s=c[g],f=(0,y.K4)(s,e);f?(t.push(f),r.push(!0),a.push(Object.values((0,R.d0)(s,e))),i.push(Object.values((0,y.tI)(s,e))),o.push(w.A.getRunName(f)),n.push(w.A.getRunDisplayName(f,s)),l.push(s)):(s?t.push({runUuid:s}):t.push({runUuid:"None"}),r.push(!1),a.push([]),i.push([]),o.push("Invalid Run"));const v=(0,D.SE)(e,d,g);h.push(Object.values(V(v.inputs))),u.push(Object.values(B(v.inputs))),p.push(Object.values(V(v.outputs))),m.push(Object.values(B(v.outputs)))}return{runInfos:t,runInfosValid:r,metricLists:a,paramLists:i,runNames:o,runDisplayNames:n,runUuids:l,modelName:d,inputsListByName:u,inputsListByIndex:h,outputsListByName:m,outputsListByIndex:p}}))((0,f.Ay)(P));var W=t(48588),K=t(25869),U=t(20109),E=t(62448);class O extends r.Component{constructor(){super(...arguments),this.registeredModelRequestId=(0,l.yk)(),this.versionRequestId=(0,l.yk)(),this.runRequestId=(0,l.yk)(),this.getMlModelFileRequestId=(0,l.yk)(),this.state={requestIds:[this.registeredModelRequestId,this.runRequestId,this.versionRequestId,this.getMlModelFileRequestId],requestIdsWith404ErrorsToIgnore:[this.runRequestId,this.getMlModelFileRequestId]}}removeRunRequestId(){this.setState((e=>({requestIds:p().without(e.requestIds,this.runRequestId)})))}componentDidMount(){this.props.getRegisteredModelApi(this.props.modelName,this.registeredModelRequestId);for(const e in this.props.versionsToRuns)if({}.hasOwnProperty.call(this.props.versionsToRuns,e)){const s=this.props.versionsToRuns[e];s?this.props.getRunApi(s,this.runRequestId).catch((()=>{this.removeRunRequestId()})):this.removeRunRequestId();const{modelName:t}=this.props;this.props.getModelVersionApi(t,e,this.versionRequestId),this.props.getModelVersionArtifactApi(t,e).then((s=>this.props.parseMlModelFile(t,e,s.value,this.getMlModelFileRequestId))).catch((()=>{this.setState((e=>({requestIds:p().without(e.requestIds,this.getMlModelFileRequestId)})))}))}}render(){return(0,H.Y)(W.L,{children:(0,H.Y)(c.Ay,{requestIds:this.state.requestIds,requestIdsWith404sToIgnore:this.state.requestIdsWith404ErrorsToIgnore,children:(0,H.Y)(L,{modelName:this.props.modelName,versionsToRuns:this.props.versionsToRuns})})})}}const j={getRunApi:n.aO,getRegisteredModelApi:d.SY,getModelVersionApi:d.s5,getModelVersionArtifactApi:d.ax,parseMlModelFile:d.qI},_=(0,K.h)((0,o.Ng)(((e,s)=>{const{location:t}=s,r=i().parse(t.search);return{modelName:decodeURIComponent(JSON.parse(r["?name"])),versionsToRuns:JSON.parse(r.runs)}}),j)(O)),G=(0,U.X)(E.A.mlflowServices.MODEL_REGISTRY,_);var J=G}}]);
//# sourceMappingURL=7023.85699bf0.chunk.js.map